<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>org on Fang's Blog</title><link>https://peromage.github.io/tags/org/</link><description>Recent content in org on Fang's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Tue, 15 Nov 2022 09:58:00 +0000</lastBuildDate><atom:link href="https://peromage.github.io/tags/org/index.xml" rel="self" type="application/rss+xml"/><item><title>File-based Blog Management with ox-hugo</title><link>https://peromage.github.io/p/file-based-blog-management-with-ox-hugo/</link><pubDate>Tue, 15 Nov 2022 09:58:00 +0000</pubDate><guid>https://peromage.github.io/p/file-based-blog-management-with-ox-hugo/</guid><description>&lt;h2 id="background">Background&lt;/h2>
&lt;p>I previously wrote a &lt;a class="link" href="https://peromage.github.io/p/use-org-mode-to-manage-my-blog/" >post&lt;/a> about managing blog posts with ox-hugo in org mode. I used to follow the recommendation to keep posts under org subtrees. As posts grew, I found that the opening speed is quite slow even I didn&amp;rsquo;t have many pictures inserted. Although managing the entire site within one file does have some convenience, the slowness is something I can&amp;rsquo;t bear.&lt;/p>
&lt;p>Also I feel it a little awkward when I use the subtree style management. I always worried about if the format was correct like how many empty lines between posts or if something was accidentally changed outside of the post that I was editing. And in order to maintain the subtree structure, the actual posts have to be indented (nested), which is not what I like. There are solutions for this nested editing. I used to use &lt;code>org-narrow-to-subtree&lt;/code> when I was editing the post and use &lt;code>widen&lt;/code> to switch the view back. But still, I always worried about the format (please forgive OCD patient).&lt;/p>
&lt;p>However, I want to continue using &lt;code>ox-hugo&lt;/code>. It is a wonderful package indeed! Luckily, it supports &lt;a class="link" href="https://ox-hugo.scripter.co/doc/usage/#for-only-the-one-post-per-file-flow" target="_blank" rel="noopener"
>file-based style&lt;/a>.&lt;/p>
&lt;h2 id="global-properties">Global properties&lt;/h2>
&lt;p>One of the benefits that subtree style brings is you can inherit properties from the parent nodes. You can put category tags on the parent node. When creating posts under it, all posts will automatically inherit the category when they get exported. Also you can set some global org settings in the header so all posts can share it.&lt;/p>
&lt;p>I want to have as much as close to this goodies when I use file-based style I created a &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/blog/blog.conf" target="_blank" rel="noopener"
>blog.conf file&lt;/a> as the global settings.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-org" data-lang="org">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># -*- mode: org; -*-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># blog.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Author.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+author&lt;/span>&lt;span class="c">: John Doe&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">On file open.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+startup&lt;/span>&lt;span class="c">: fold&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+startup&lt;/span>&lt;span class="c">: indent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+startup&lt;/span>&lt;span class="c">: logdone&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+startup&lt;/span>&lt;span class="c">: logdrawer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Todo states.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+seq_todo&lt;/span>&lt;span class="c">: DRAFT(d) | CREATED(c!) PUBLISHED(p!)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Categories.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">This is mainly for subtree-based export style.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+tags&lt;/span>&lt;span class="c">: @emacs @coding @linux @tech @ramble @折腾&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Posts under categories are expected to read this so the path is relative to the post files.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+hugo_base_dir&lt;/span>&lt;span class="c">: ../../hugo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Default section.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+hugo_section&lt;/span>&lt;span class="c">: blog&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Date and time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+hugo_auto_set_lastmod&lt;/span>&lt;span class="c">: t&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+options&lt;/span>&lt;span class="c">: d:t&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>When starting a new post, simple use it as the setup file. The editing experience will be consistent. If some settings needs to be overridden in this post specifically, put them before the &lt;code>#+setupfile&lt;/code> directive (same settings only the first occurrence gets applied).&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-org" data-lang="org">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># new-post.org&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+startup&lt;/span>&lt;span class="c">: nofold&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+setupfile&lt;/span>&lt;span class="c">: ./blog.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Something needs to be noticed is, as you can see, I&amp;rsquo;ve put some descriptions in the config file. Don&amp;rsquo;t worry. Only org directives will be read when used by &lt;code>#+setupfile&lt;/code>. This is great because it gives you flexibility to keep comments of those settings in case you forget in the future.&lt;/p>
&lt;h2 id="inherit-category">Inherit category&lt;/h2>
&lt;p>I also want to have the ability to inherit category so I don&amp;rsquo;t need to manually type it. Indeed I sometimes forget what categories I have if I don&amp;rsquo;t write blog for a while.&lt;/p>
&lt;p>To achieve this, I created a few subfolders as categories and put posts under them respectively. Then I created another &lt;code>blog.conf&lt;/code> under each category folder with the settings.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-org" data-lang="org">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># emacs/blog.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+hugo_categories&lt;/span>&lt;span class="c">: emacs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cs">#+setupfile&lt;/span>&lt;span class="c">: ../blog.conf&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Don&amp;rsquo;t doubt it. &lt;code>#+setupfile&lt;/code> can be used recursively! Fantastic! Now new posts under emacs category just need to include this file in their headers and they will be assigned to this category automatically during export.&lt;/p>
&lt;h2 id="hugo-pages">Hugo pages&lt;/h2>
&lt;p>I actually use &lt;code>ox-hugo&lt;/code> in a hybrid way. For navigation pages, I continue managing &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/blog/hugo-pages.org" target="_blank" rel="noopener"
>them&lt;/a> with subtrees and overriding settings if it&amp;rsquo;s different from the global with heading properties.&lt;/p>
&lt;h2 id="export-script">Export script&lt;/h2>
&lt;p>I used to use a shell script to export. Just realized that Emacs had script support since version 22 so I created a &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/blog/ox-hugo-export.el" target="_blank" rel="noopener"
>Elisp script&lt;/a> for this purpose.&lt;/p>
&lt;h2 id="similar-solution">Similar solution&lt;/h2>
&lt;p>This can also be achieved by using Emacs local variable but it will ask you to confirm if those variables are safe if you don&amp;rsquo;t persist the settings. I find it quite annoying especially used with CI. It will most likely break CI if you are not careful.&lt;/p>
&lt;p>However, this is more convenience than the header method when you have nested folder structures. It can calculate the Hugo base path when the variables get evaluated.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">((org-mode . ((eval . (setq org-hugo-base-dir (locate-dominating-file default-directory &amp;#34;.git&amp;#34;))))))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Be careful when using it with CI.&lt;/p>
&lt;h2 id="folder-structure">Folder structure&lt;/h2>
&lt;p>My folder structure finally looks like this.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── coding
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post1.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post2.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post3.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── blog.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── emacs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post1.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post2.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post3.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── blog.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post1.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post2.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post3.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── blog.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── tech
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post1.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post2.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post3.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── blog.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── blog.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── hugo-pages.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── ox-hugo-export.el
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="summary">Summary&lt;/h2>
&lt;p>Now I feel it much clearer. &lt;code>ox-hugo&lt;/code> is a definitely a fantastic package. It helps me manage posts in org mode and seamlessly work with Hugo with ease.&lt;/p>
&lt;p>If you haven&amp;rsquo;t used either org mode or Hugo, I highly recommend to give them a try.&lt;/p></description></item><item><title>Use Org Mode to Manage My Blog</title><link>https://peromage.github.io/p/use-org-mode-to-manage-my-blog/</link><pubDate>Sun, 05 Jun 2022 23:00:00 +0000</pubDate><guid>https://peromage.github.io/p/use-org-mode-to-manage-my-blog/</guid><description>&lt;p>I&amp;rsquo;ve been using Emacs since last year but until recent I started using &lt;code>org-mode&lt;/code> seriously. After spending a couple of days reading and watching all kinds of org tutorial as well as using it for documentation, I realized that people who invented this must geniuses.&lt;/p>
&lt;p>Org document seems similar with Markdown: they are text markup format. However, Org provides far more capabilities to store metadata and greater editing experience together with Emacs&amp;rsquo; &lt;code>org-mode&lt;/code>.&lt;/p>
&lt;h2 id="motivation">Motivation&lt;/h2>
&lt;p>I used to use Markdown to write my blog articles and use &lt;em>Hugo&lt;/em> to generate static files.&lt;/p>
&lt;p>The workflow is pretty much like:&lt;/p>
&lt;ol>
&lt;li>Create a new Markdown with header by either snippet template from text editor or Hugo command.&lt;/li>
&lt;li>Write the article.&lt;/li>
&lt;li>Set last modified time upon finished.&lt;/li>
&lt;li>Commit and push then let GitHub CI to generate static files automatically.&lt;/li>
&lt;/ol>
&lt;p>It looks typical but later on I found it was really frustrating to manage my articles:&lt;/p>
&lt;ol>
&lt;li>I always forgot to update the last modified time.&lt;/li>
&lt;li>Tags and categories were set in the header each file. It&amp;rsquo;s difficult check existing tags and categories and make them consistent in the new articles. For example, I always forgot whether a tag or category was capitalized or dash separated.&lt;/li>
&lt;li>Painful to browse.&lt;/li>
&lt;/ol>
&lt;p>Because of those troubles I gradually lost interests writing articles until I found &lt;code>org-mode&lt;/code>. So I started planning to manage my articles with it.&lt;/p>
&lt;h2 id="choose-the-right-way">Choose the Right Way&lt;/h2>
&lt;p>By checking Hugo&amp;rsquo;s documents, I found that it supports Org backend with &lt;a class="link" href="https://github.com/niklasfasching/go-org" target="_blank" rel="noopener"
>go-org&lt;/a>. However it seems like just another Markdown method but in Org syntax. Apparently it doesn&amp;rsquo;t use the full Org capabilities.&lt;/p>
&lt;p>Later I found &lt;a class="link" href="https://ox-hugo.scripter.co/" target="_blank" rel="noopener"
>ox-hugo&lt;/a> which is an Org backend in Emacs used for Org file export. The idea is to write articles in Org syntax with metadata and whatever you like to do in &lt;code>org-mode&lt;/code> and then export to Markdown files through &lt;code>ox-hugo&lt;/code>. Finally feed the Markdown files to the Hugo engine. The killer feature is that it supports exporting from subtrees, which means you can manage all my articles in one file categorize them with ease (by the first level outline). And since all the articles are in the same visible file, they can be refiled and move around with &lt;code>org-mode&lt;/code> key bindings. Also all tags are visible and can be applied very easily. It gives you a lot flexibility to manage the articles in this way.&lt;/p>
&lt;p>At the time when this article is read, it&amp;rsquo;s been written in &lt;code>org-mode&lt;/code> already. I even use the same file to manage other pages of my blog like about, archives and search pages. You can checkout my original Org file &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/myblog/blog.org" target="_blank" rel="noopener"
>here&lt;/a> to figure out how they are defined.&lt;/p>
&lt;h2 id="update-ci-to-build-static-files-on-pushing">Update CI to Build Static Files on Pushing&lt;/h2>
&lt;p>Since all the articles are managed by the Org file there is no point to keep the old Markdown files. I need to make GitHub CI export the Org file for me so I don&amp;rsquo;t have to do it locally.&lt;/p>
&lt;p>The problem is to setup Emacs on the job runner. Luckily there are people doing this already by providing a GitHub &lt;a class="link" href="https://github.com/marketplace/actions/set-up-emacs" target="_blank" rel="noopener"
>action&lt;/a>. Thanks Steve Purcell and the people who worked on this!&lt;/p>
&lt;p>Now with the Emacs setup ready, one problem left is to export from Org files to Markdown. The idea is pretty straight forward: install &lt;code>ox-hugo&lt;/code> from MELPA and export through it. A simple shell command should do the job.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">emacs -nw --batch --eval &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="s1">&amp;#39;(progn
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (package-initialize)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (add-to-list (quote package-archives) (quote (&amp;#34;melpa&amp;#34; . &amp;#34;https://melpa.org/packages/&amp;#34;)))
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (package-refresh-contents)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (package-install (quote ox-hugo))
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (find-file &amp;#34;myblog/blog.org&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> (org-hugo-export-wim-to-md :all))&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>After that, feed the generated Markdown files to Hugo engine. No difference from the typical Hugo &lt;a class="link" href="https://gohugo.io/hosting-and-deployment/hosting-on-github/" target="_blank" rel="noopener"
>workflow&lt;/a>.&lt;/p>
&lt;p>See here for my &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/org-export.sh" target="_blank" rel="noopener"
>job runner script&lt;/a> and &lt;a class="link" href="https://github.com/peromage/peromage.github.io/blob/master/.github/workflows/gh-pages.yml" target="_blank" rel="noopener"
>workflow configuration&lt;/a>.&lt;/p>
&lt;h2 id="fix-the-last-modified-date">Fix the Last Modified Date&lt;/h2>
&lt;p>By doing this workflow all the files are always generated so their last modified date are constantly changed (with &lt;code>#+hugo_auto_set_lastmod: t&lt;/code> in the header). &lt;code>ox-hugo&lt;/code> seems not to have a proper solution to calculate the diff between changes (could be hard though). The best way to solve this is to add either a &lt;code>:LOGBOOK:&lt;/code> or a &lt;code>EXPORT_HUGO_LASTMOD&lt;/code> property to the subtree. Or even simpler to use &lt;em>TODO&lt;/em> and &lt;em>DONE&lt;/em> workflow since it generates &lt;code>:LOGBOOK:&lt;/code> automatically. When any one of them specified &lt;code>ox-hugo&lt;/code> will the value from it &lt;a class="link" href="https://ox-hugo.scripter.co/doc/dates/#last-modified" target="_blank" rel="noopener"
>instead of generating a new date&lt;/a>.&lt;/p>
&lt;p>Since manually changing the modification time in &lt;code>EXPORT_HUGO_LASTMOD&lt;/code> sucks and it&amp;rsquo;s the same solution back in the Markdown style, this time I decided to use &amp;ldquo;Org&amp;rdquo; way to fix this problem. By looking at the document, &lt;code>:LOGBOOK:&lt;/code> has &lt;a class="link" href="https://ox-hugo.scripter.co/doc/org-meta-data-to-hugo-front-matter/#front-matter-precedence" target="_blank" rel="noopener"
>the highest priority&lt;/a> among other options and also has a synergy with todo workflow. That&amp;rsquo;s cool. I can treat my article writing like any other tasks.&lt;/p>
&lt;p>But I don&amp;rsquo;t quite like the default keywords &lt;em>TODO&lt;/em> and &lt;em>DONE&lt;/em> since they doesn&amp;rsquo;t sound semantic to the articles. So I added a header to my blog Org file: &lt;code>#+seq_todo: DRAFT(d) | PUBLISHED(p!)&lt;/code>.&lt;/p>
&lt;p>Then I found another problem that whenever I change the state from &lt;em>DRAFT&lt;/em> to &lt;em>PUBLISHED&lt;/em> there is always a &lt;code>CLOSED&lt;/code> time property added to the article. This is because I have &lt;code>(setq org-log-done 'time)&lt;/code> in my Emacs configuration file. It duplicates &lt;code>:LOGBOOK:&lt;/code> since it has already logged the transition time and I don&amp;rsquo;t want to change my Emacs configuration specific for this file. So I added another header to my blog Org file: &lt;code>#+startup: nologdone&lt;/code> and also make sure the state transition records are always put into the drawer: &lt;code>#+startup: logdrawer&lt;/code>.&lt;/p>
&lt;p>Okay now I should be able to start a new article with &lt;em>DRAFT&lt;/em> prefix and then use &lt;code>C-c C-t&lt;/code> to change it to &lt;em>PUBLISHED&lt;/em> whenever I&amp;rsquo;m done writing. However things are still not going as I expected. Remember the &lt;a class="link" href="https://ox-hugo.scripter.co/doc/org-meta-data-to-hugo-front-matter/#front-matter-precedence" target="_blank" rel="noopener"
>date precedence&lt;/a> page? The first transition to &lt;em>PUBLISHED&lt;/em> state record is recognized as the creation date. Only the second or later records to &lt;em>PUBLISHED&lt;/em> state will be read as the last modified date. That&amp;rsquo;s dumb. To fix this, I added a new todo item and now it&amp;rsquo;s like: &lt;code>#+seq_todo: DRAFT(d) | CREATED(c!) PUBLISHED(p!)&lt;/code>.&lt;/p>
&lt;p>Now my blog header is like:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">#+author: Fang Deng
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+startup: show2levels
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+startup: nologdone
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+startup: logdrawer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+seq_todo: DRAFT(d) | CREATED(c!) PUBLISHED(p!)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+options: d:t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+hugo_base_dir: ../
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+hugo_section: blog
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#+hugo_auto_set_lastmod: t
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Don&amp;rsquo;t forget the &lt;code>#+options: d:t&lt;/code>. &lt;code>ox-hugo&lt;/code> will not export &lt;code>:LOGBOOK:&lt;/code> without it.&lt;/p>
&lt;p>Finally a sweet snippet file to save my life.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># -*- mode: snippet -*-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># name: Hugo new article
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># key: hugonew
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">** DRAFT ${1:TITLE}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:PROPERTIES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:EXPORT_FILE_NAME: ${1:$(replace-regexp-in-string &amp;#34;[^A-Za-z0-9._-]&amp;#34; &amp;#34;&amp;#34; (replace-regexp-in-string &amp;#34; &amp;#34; &amp;#34;-&amp;#34; (downcase yas-text)))}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:END:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:LOGBOOK:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- State &amp;#34;CREATED&amp;#34; from [`(string-trim (format-time-string (cdr org-time-stamp-formats)) &amp;#34;&amp;lt;&amp;#34; &amp;#34;&amp;gt;&amp;#34;)`]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:END:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now a new article will come with its creation time. Whenever the article is done, &lt;code>C-c C-t&lt;/code> to mark it &lt;em>PUBLISHED&lt;/em> which will be the last modified time. If the article is modified in the future, simply &lt;code>C-c C-t&lt;/code> again to add another &lt;em>PUBLISHED&lt;/em> state and the last modified time will be refreshed on export. Now I have a neat log book to record my changes. No more manually editing suckers!&lt;/p></description></item></channel></rss>